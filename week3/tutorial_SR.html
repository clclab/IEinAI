
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Tutorial: Symbolic Regression &#8212; Interpretability &amp; Explainability in AI — Workshop materials</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'week3/tutorial_SR';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Interpretability & Explainability in AI — Workshop materials - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Interpretability & Explainability in AI — Workshop materials - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to the IEinAI Workshop Materials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Workshop Materials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../week1/week1_intro.html">Week 1</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../week1/w1a_IEinAi_probing_student_version.html">1.1: Introduction to Posthoc Interpretability</a></li>


<li class="toctree-l2"><a class="reference internal" href="../week1/w1b_IEinAI_attribution_student_version.html">1.2: Feature Attribution for Language Models — Approaches and Evaluation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mechinterp/mechinterp_intro.html">Mechanistic Interpretability</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../speech-perception/speech-perception_intro.html">Speech Perception</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../speech-perception/speech_perception_lab1_probing.html">Workshop on Speech Perception, Part 1: Probing acoustic, phonemic and orthographic information in Wav2Vec2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../speech-perception/speech_perception_lab2_CKA.html">Workshop on Speech Perception, Part 2: Comparing Audio Transformer representations with Centered Kernel Alignment</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/clclab/IEinAI/blob/main/book/week3/tutorial_SR.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/clclab/IEinAI" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/clclab/IEinAI/issues/new?title=Issue%20on%20page%20%2Fweek3/tutorial_SR.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/week3/tutorial_SR.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial: Symbolic Regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-0-introduction">Section 0: Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-generation">Data Generation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-1-introduction-to-non-symbolic-regression-methods">Section 1: Introduction to Non-Symbolic Regression Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-train-and-testdatasets">Create train- and testdatasets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training-the-models">Training the models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-1pts-total">Question 1 (1pts total)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q1a-0-5pts-describe-what-results-you-see-in-the-figure">Q1a - (0.5pts): Describe what results you see in the figure.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q1b-0-5pts-can-you-think-of-at-least-two-possible-limitations-to-using-non-symbolic-regression-methods-for-symbolic-regression">Q1b - (0.5pts): Can you think of at least two possible limitations to using non-symbolic regression methods for symbolic regression?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-2-introduction-to-symbolic-regression-methods-gplearn">Section 2: Introduction to Symbolic Regression Methods (GPLearn)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gplearn">2-1: GPLearn</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-1pts-describe-what-results-you-see-in-the-figure-what-are-your-thoughts-so-far-on-using-gplearn-for-symbolic-regression">Question 2 (1pts): Describe what results you see in the figure. What are your thoughts so far on using GPLearn for (symbolic) regression?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-3-comparing-non-symbolic-regression-vs-symbolic-regression">Section 3: Comparing Non-Symbolic Regression vs. Symbolic Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pysr">3-1: PySR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gfn-sr">3-2: GFN-SR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-3-total-2pts">Question 3 (total 2pts)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q3a-0-5pts-for-the-complete-output-of-pysr-check-the-hall-of-fame-csv-file-what-is-meant-by-the-complexity-of-pysr">Q3a - (0.5pts) For the complete output of PySR, check the hall_of_fame-csv-file. What is meant by the complexity of PySR?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q3b-1-5pts-what-are-the-expressions-generated-for-the-equation-y-x1-2-x1-2-x2-1-by-all-three-symbolic-regression-methods-e-g-gplearn-pysr-gfn-sr-for-pysr-choose-an-equation-of-appropriate-complexity-to-compare-which-method-do-you-prefer-now-and-why">Q3b - (1.5pts): What are the expressions generated for the equation y = x1^2 - x1^2 + x2 - 1 by all three symbolic regression methods (e.g. GPLearn, PySR, GFN-SR)? For PySR, choose an equation of appropriate complexity to compare. Which method do you prefer now and why?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-4-total-2pts">Question 4 (total 2pts)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q4a-0-5pts-compare-the-generated-decision-rules-of-the-non-symbolic-regressors-against-each-of-the-symbolic-expressions-which-one-do-you-prefer-and-why-show-how-you-compare-the-methods">Q4a - (0.5pts): Compare the generated decision rules of the non-symbolic regressors against each of the symbolic expressions. Which one do you prefer and why? Show how you compare the methods.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q4b-1-5pts-create-another-example-equation-that-results-in-a-less-interpretable-solution-for-the-non-symbolic-regression-methods-in-comparison-to-the-symbolic-regression-compare-these-decision-rules-that-you-generated-with-dt-and-rf-to-the-symbolic-regressors-in-terms-of-complexity-compactness-and-r-squared-report-all-your-findings">Q4b (1.5pts): Create another example equation that results in a less interpretable solution for the non-symbolic regression methods in comparison to the symbolic regression. Compare these decision rules that you generated with DT and RF to the symbolic regressors in terms of complexity, compactness and R-squared. Report all your findings.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-4-comparing-the-symbolic-regression-methods">Section 4: Comparing the Symbolic Regression Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#increasing-the-complexity">4-1: Increasing the complexity</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-5-3pts-for-all-six-functions-below-run-the-three-symbolic-regression-methods-report-its-performance-in-terms-of-the-mse-and-r2-score-describe-what-you-observe-and-conclude">Question 5 (3pts): For all six functions below, run the three symbolic regression methods. Report its performance in terms of the MSE and R2-score. Describe what you observe and conclude.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-question-6-0-5pts-increase-the-number-of-features-by-one-and-compare-the-performances-of-the-three-methods-based-on-your-own-equation-involving-three-features">[OPTIONAL] Question 6 (0.5pts): Increase the number of features by one and compare the performances of the three methods based on your own equation involving three features.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sensitivity-to-noise">4-2: Sensitivity to noise</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-question-7-0-5pts-add-a-noise-term-to-your-data-set-this-noise-should-be-normally-distributed-between-with-a-mean-of-0-and-standard-deviation-of-0-02-considering-performance-you-may-choose-a-metric-yourself-and-runtime-which-method-is-most-robust">[OPTIONAL] Question 7 (0.5pts): Add a noise term to your data set. This noise should be normally distributed between with a mean of 0 and standard deviation of 0.02. Considering performance (you may choose a metric yourself) and runtime, which method is most robust?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application-to-real-world-benchmark-dataset-ai-feynman">4-3: Application to real-world benchmark dataset: AI Feynman</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-question-8-2pts-go-to-https-arxiv-org-abs-1905-11481-and-find-equations-i-12-2-i-48-20-i-13-4-i-27-6-i-18-12-and-i-29-16-what-can-you-say-about-the-structure-of-these-functions-then-use-gplearn-pysr-and-gfn-sr-on-these-equations-you-may-use-a-dataset-of-a-50-samples-with-values-between-1-and-10-without-noise-based-on-your-findings-in-the-previous-question-which-method-do-you-think-works-best-is-there-one-method-overall-or-do-you-think-one-method-works-best-for-certain-equations">[OPTIONAL] Question 8 (2pts): Go to https://arxiv.org/abs/1905.11481 and find equations I.12.2, I.48.20, I.13.4, I.27.6, I.18.12 and I.29.16. What can you say about the structure of these functions? Then, Use GPLearn, PySR and GFN-SR on these equations. You may use a dataset of a 50 samples with values between 1 and 10 (without noise). Based on your findings in the previous question, which method do you think works best? Is there one method overall, or do you think one method works best for certain equations?</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tutorial-symbolic-regression">
<h1>Tutorial: Symbolic Regression<a class="headerlink" href="#tutorial-symbolic-regression" title="Link to this heading">#</a></h1>
<p>Welcome to this tutorial on symbolic regression! Symbolic regression offers the unique advantage of creating inherently explainable models by uncovering mathematical expressions that describe data. Once a prominent technique, it has been overshadowed by more complex methods, making it an old and forgotten child of machine learning. However, recent advancements have rekindled interest in its capabilities.</p>
<p>Symbolic regression stands out for its ability to produce models that are both accurate and interpretable. By revealing the underlying mathematical relationships in data, it allows for greater insight and understanding, making it a valuable tool in various fields. In this tutorial you will use and compare the following methods to discover relationships between datapoints.</p>
<ol class="arabic simple">
<li><p>Non-symbolic regression methods:</p>
<ol class="arabic simple">
<li><p>Decision Tree Regression</p></li>
<li><p>Random Forest Regression</p></li>
</ol>
</li>
<li><p>Symbolic regression methods:</p>
<ol class="arabic simple">
<li><p>GPLearn: SR based on genetic programming by Trevor Stephens (2015)  (<a class="github reference external" href="https://github.com/trevorstephens/gplearn">trevorstephens/gplearn</a>)</p></li>
<li><p>PySR: SR based on a multi-population evolutionary algoritm by Miles Cranmer (2023) (<a class="reference external" href="https://arxiv.org/abs/2305.01582">https://arxiv.org/abs/2305.01582</a>)</p></li>
<li><p>GFN-SR: Symbolic regression with generative flow networks by Li et al. (2023) (<a class="reference external" href="https://arxiv.org/abs/2312.00396">https://arxiv.org/abs/2312.00396</a>)</p></li>
</ol>
</li>
</ol>
<p>The notebook introduces you to symbolic regression with some initial examples, followed by exercises and snippets of your own code.</p>
<section id="section-0-introduction">
<h2>Section 0: Introduction<a class="headerlink" href="#section-0-introduction" title="Link to this heading">#</a></h2>
<p>Before we start, we import all relevant packages below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN THIS CELL FIRST. Do not change.</span>

<span class="kn">from</span> <span class="nn">gplearn.genetic</span> <span class="kn">import</span> <span class="n">SymbolicRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span><span class="p">,</span> <span class="n">export_text</span>
<span class="kn">from</span> <span class="nn">sklearn.utils.random</span> <span class="kn">import</span> <span class="n">check_random_state</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<section id="data-generation">
<h3>Data Generation<a class="headerlink" href="#data-generation" title="Link to this heading">#</a></h3>
<p>First, we create the data used for the three methods mentioned above. The code below creates a surfaceplot of all points (x1,x2) between -1 and 1 for two features x1 and x2, according to the equation y_truth = x1^2 - x1^2 + x2 - 1. In the methods below we will try to find an equation that best fits y_truth.</p>
<p>Recall that in case of symbolic regression, the goal is to find an equation. In this example, the true equation is non-linear. To compare to other non-linear methods, we include Decision Tree (DT) Regression and Random Forest (RF) Regression. However, these methods will not produce an equation, but will simply train a DT or RF that best matches the given data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN THIS CELL. Do not change.</span>

<span class="c1"># Generating data</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
<span class="n">y_truth</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">-</span> <span class="mi">1</span>

<span class="c1"># Creating surface plot of y_truth</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y_truth</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/74aa531a27d3818ca16dd1dffeab5f87f166a4cc36fbaa6b8abe516dfffb122c.png" src="../_images/74aa531a27d3818ca16dd1dffeab5f87f166a4cc36fbaa6b8abe516dfffb122c.png" />
</div>
</div>
</section>
</section>
<section id="section-1-introduction-to-non-symbolic-regression-methods">
<h2>Section 1: Introduction to Non-Symbolic Regression Methods<a class="headerlink" href="#section-1-introduction-to-non-symbolic-regression-methods" title="Link to this heading">#</a></h2>
<p>In this section, we’ll explore non-symbolic regression methods, which highlight the need for symbolic regression. Non-symbolic methods, like Decision Tree (DT) Regression and Random Forest (RF) Regression, are effective for prediction but have notable limitations. Note that non-symbolic regression methods will not produce an equation, but simply an output.</p>
<section id="create-train-and-testdatasets">
<h3>Create train- and testdatasets<a class="headerlink" href="#create-train-and-testdatasets" title="Link to this heading">#</a></h3>
<p>We’ll now create the actual train and test data. The train dataset will consist of a 100 samples. We use y = x1^2 - x1^2 + x2 - 1. Running the cell below shows you the first five samples of all 100 samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN THIS CELL. Do not change.</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Training samples</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Testing samples</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">X_test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X_test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         x1        x2         y
0  0.097627  0.430379 -0.745316
1  0.205527  0.089766 -0.876050
2 -0.152690  0.291788 -0.770038
3 -0.124826  0.783546 -0.814817
4  0.927326 -0.233117 -0.427528
</pre></div>
</div>
</div>
</div>
</section>
<section id="training-the-models">
<h3>Training the models<a class="headerlink" href="#training-the-models" title="Link to this heading">#</a></h3>
<p>We train a Decision Tree Regression model and Random Forest Regression model. Tree Regression methods aim to find a tree that will travel through the branches to end up in a note with the value closest to the target value. For example, given sample a new samle (x1,x2) = (4.0, 2.0). The tree regressor may create decision rules such as <code class="docutils literal notranslate"><span class="pre">(x1</span> <span class="pre">&lt;=</span> <span class="pre">5.0)</span> <span class="pre">and</span> <span class="pre">(x2</span> <span class="pre">&lt;=</span> <span class="pre">3.0),</span> <span class="pre">then</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">3.5</span></code>. The decision rules created should produce output values that closely matches the y-column of our datadet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN THIS CELL. </span>

<span class="c1"># Fit Decision Tree and Random Forest regression</span>
<span class="n">est_tree</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">()</span>
<span class="n">est_tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1">####</span>
<span class="c1"># (Optional for Question 6) YOUR CODE HERE</span>
<span class="c1">####</span>

<span class="n">est_rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span>
<span class="n">est_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestRegressor()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;RandomForestRegressor<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.ensemble.RandomForestRegressor.html">?<span>Documentation for RandomForestRegressor</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>RandomForestRegressor()</pre></div> </div></div></div></div></div></div>
</div>
<p>We visualize the output below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN THIS CELL. Do not change.</span>

<span class="n">y_tree</span> <span class="o">=</span> <span class="n">est_tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">x1</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">x2</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">score_tree</span> <span class="o">=</span> <span class="n">est_tree</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="n">y_rf</span> <span class="o">=</span> <span class="n">est_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">x1</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">x2</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">score_rf</span> <span class="o">=</span> <span class="n">est_rf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([(</span><span class="n">y_truth</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Ground Truth&quot;</span><span class="p">),</span>
                                    <span class="c1">#    (y_gp, score_gp, &quot;SymbolicRegressor&quot;),</span>
                                       <span class="p">(</span><span class="n">y_tree</span><span class="p">,</span> <span class="n">score_tree</span><span class="p">,</span> <span class="s2">&quot;DecisionTreeRegressor&quot;</span><span class="p">),</span>
                                       <span class="p">(</span><span class="n">y_rf</span><span class="p">,</span> <span class="n">score_rf</span><span class="p">,</span> <span class="s2">&quot;RandomForestRegressor&quot;</span><span class="p">)]):</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">score</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">.2</span><span class="p">,</span> <span class="s2">&quot;$R^2 =\/ </span><span class="si">%.6f</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="n">score</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:21: SyntaxWarning: invalid escape sequence &#39;\/&#39;
&lt;&gt;:21: SyntaxWarning: invalid escape sequence &#39;\/&#39;
/var/folders/9f/hchm_zr16lvg9fx_7pdqcws80000gn/T/ipykernel_94078/790698944.py:21: SyntaxWarning: invalid escape sequence &#39;\/&#39;
  score = ax.text(-.7, 1, .2, &quot;$R^2 =\/ %.6f$&quot; % score, &#39;x&#39;, fontsize=8)
</pre></div>
</div>
<img alt="../_images/bfcdd47e10b5b35102cf4a4a8032ea29adf1afd63d44523a46dc029c30867ad2.png" src="../_images/bfcdd47e10b5b35102cf4a4a8032ea29adf1afd63d44523a46dc029c30867ad2.png" />
</div>
</div>
</section>
<section id="question-1-1pts-total">
<h3>Question 1 (1pts total)<a class="headerlink" href="#question-1-1pts-total" title="Link to this heading">#</a></h3>
<section id="q1a-0-5pts-describe-what-results-you-see-in-the-figure">
<h4>Q1a - (0.5pts): Describe what results you see in the figure.<a class="headerlink" href="#q1a-0-5pts-describe-what-results-you-see-in-the-figure" title="Link to this heading">#</a></h4>
</section>
<section id="q1b-0-5pts-can-you-think-of-at-least-two-possible-limitations-to-using-non-symbolic-regression-methods-for-symbolic-regression">
<h4>Q1b - (0.5pts): Can you think of at least two possible limitations to using non-symbolic regression methods for symbolic regression?<a class="headerlink" href="#q1b-0-5pts-can-you-think-of-at-least-two-possible-limitations-to-using-non-symbolic-regression-methods-for-symbolic-regression" title="Link to this heading">#</a></h4>
</section>
</section>
</section>
<section id="section-2-introduction-to-symbolic-regression-methods-gplearn">
<h2>Section 2: Introduction to Symbolic Regression Methods (GPLearn)<a class="headerlink" href="#section-2-introduction-to-symbolic-regression-methods-gplearn" title="Link to this heading">#</a></h2>
<p>Symbolic regression has traditionally relied on Genetic Programming (GP) to discover mathematical equations that describe data. In GP, equations are represented as tree-like structures, where nodes are mathematical operators and leaves are variables or constants. New equations are generated through evolutionary processes like mutation and crossover of these trees, mimicking natural selection. This approach allows for the exploration of a vast space of possible equations.</p>
<p>In this section, we will introduce GPLearn, a Python library that utilizes genetic programming for symbolic regression. We will explore how GPLearn works and why symbolic regression is valuable for creating interpretable models that reveal the underlying mathematical relationships in data.</p>
<section id="gplearn">
<h3>2-1: GPLearn<a class="headerlink" href="#gplearn" title="Link to this heading">#</a></h3>
<p>We’ll begin by training a model using GPLearn, a genetic programming library for symbolic regression. The resulting equations will be composed of basic arithmetic operators: addition, subtraction, division, and multiplication.</p>
<p>For example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">add(x1,3.0)</span></code> represents x1+3.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sub(x2,add(x1,3.0))</span></code> represents x2-(x1+3).</p></li>
</ul>
<p>This introduction to GPLearn will include a comparison with Decision Tree (DT) Regression and Random Forest (RF) Regression, highlighting the unique advantages and interpretability of symbolic regression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN THIS CELL. Do not change.</span>

<span class="c1"># Fit SymbolicRegressor</span>
<span class="n">est_gp</span> <span class="o">=</span> <span class="n">SymbolicRegressor</span><span class="p">(</span><span class="n">population_size</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
                           <span class="n">generations</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">stopping_criteria</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                           <span class="n">p_crossover</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">p_subtree_mutation</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                           <span class="n">p_hoist_mutation</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">p_point_mutation</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                           <span class="n">max_samples</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                           <span class="n">parsimony_coefficient</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">est_gp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Generate equation</span>
<span class="nb">print</span><span class="p">(</span><span class="n">est_gp</span><span class="o">.</span><span class="n">_program</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    |   Population Average    |             Best Individual              |
---- ------------------------- ------------------------------------------ ----------
 Gen   Length          Fitness   Length          Fitness      OOB Fitness  Time Left
   0    38.13          458.578        5         0.320666         0.556764     35.95s
   1     9.97          1.70233        5         0.320202         0.624787     21.60s
   2     7.72          1.94456       11         0.239537         0.533148     19.36s
   3     5.41         0.990157        7         0.235676         0.719906     17.85s
   4     4.66         0.894443       11         0.103946         0.103946     17.00s
   5     5.41         0.940242       11         0.060802         0.060802     15.92s
   6     6.78          1.09536       11      0.000781474      0.000781474     14.53s
sub(add(-0.999, X1), mul(sub(X1, X0), add(X0, X1)))
</pre></div>
</div>
</div>
</div>
<p>We visualize the output and compare to the non-symbolic regression methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN THIS CELL. Do not change.</span>

<span class="n">y_gp</span> <span class="o">=</span> <span class="n">est_gp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">x1</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">x2</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">score_gp</span> <span class="o">=</span> <span class="n">est_gp</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([(</span><span class="n">y_truth</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Ground Truth&quot;</span><span class="p">),</span>
                                       <span class="p">(</span><span class="n">y_gp</span><span class="p">,</span> <span class="n">score_gp</span><span class="p">,</span> <span class="s2">&quot;SymbolicRegressor&quot;</span><span class="p">),</span>
                                       <span class="p">(</span><span class="n">y_tree</span><span class="p">,</span> <span class="n">score_tree</span><span class="p">,</span> <span class="s2">&quot;DecisionTreeRegressor&quot;</span><span class="p">),</span>
                                       <span class="p">(</span><span class="n">y_rf</span><span class="p">,</span> <span class="n">score_rf</span><span class="p">,</span> <span class="s2">&quot;RandomForestRegressor&quot;</span><span class="p">)]):</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">score</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">.2</span><span class="p">,</span> <span class="s2">&quot;$R^2 =\/ </span><span class="si">%.6f</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="n">score</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:19: SyntaxWarning: invalid escape sequence &#39;\/&#39;
&lt;&gt;:19: SyntaxWarning: invalid escape sequence &#39;\/&#39;
/var/folders/9f/hchm_zr16lvg9fx_7pdqcws80000gn/T/ipykernel_94078/3905327180.py:19: SyntaxWarning: invalid escape sequence &#39;\/&#39;
  score = ax.text(-.7, 1, .2, &quot;$R^2 =\/ %.6f$&quot; % score, &#39;x&#39;, fontsize=8)
</pre></div>
</div>
<img alt="../_images/35f6b2df4efce5c9ac53561892fd801d519aa1bbd649b7350ff029fce746458f.png" src="../_images/35f6b2df4efce5c9ac53561892fd801d519aa1bbd649b7350ff029fce746458f.png" />
</div>
</div>
<section id="question-2-1pts-describe-what-results-you-see-in-the-figure-what-are-your-thoughts-so-far-on-using-gplearn-for-symbolic-regression">
<h4>Question 2 (1pts): Describe what results you see in the figure. What are your thoughts so far on using GPLearn for (symbolic) regression?<a class="headerlink" href="#question-2-1pts-describe-what-results-you-see-in-the-figure-what-are-your-thoughts-so-far-on-using-gplearn-for-symbolic-regression" title="Link to this heading">#</a></h4>
</section>
</section>
</section>
<section id="section-3-comparing-non-symbolic-regression-vs-symbolic-regression">
<h2>Section 3: Comparing Non-Symbolic Regression vs. Symbolic Regression<a class="headerlink" href="#section-3-comparing-non-symbolic-regression-vs-symbolic-regression" title="Link to this heading">#</a></h2>
<p>In this section, we will compare non-symbolic regression methods with three established symbolic regression methods. You will explore how to perform each approach and understand the benefits of symbolic regression in providing interpretable models.</p>
<p>The methods we will compare are:</p>
<ol class="arabic simple">
<li><p>Decision Tree Regression (Non-Symbolic)</p></li>
<li><p>Random Forest Regression (Non-Symbolic)</p></li>
<li><p>GPLearn (Symbolic)</p></li>
<li><p>PySR (Symbolic)</p></li>
<li><p>GFN-SR (Symbolic)</p></li>
</ol>
<section id="pysr">
<h3>3-1: PySR<a class="headerlink" href="#pysr" title="Link to this heading">#</a></h3>
<p>We’ve established that the symbolic regression method GPLearn performs comparably to traditional regression methods (DT and RF). Now, let’s explore and compare the remaining two prominent symbolic regression methods (PySr and GFN-SR)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN THIS CELL. Do not change.</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;PySR&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">pysr</span> <span class="kn">import</span> <span class="n">PySRRegressor</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">PySRRegressor</span><span class="p">(</span>
    <span class="n">niterations</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>  <span class="c1"># &lt; Increase me for better results</span>
    <span class="n">binary_operators</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">],</span>
    <span class="n">unary_operators</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;cos&quot;</span><span class="p">,</span>
        <span class="s2">&quot;exp&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sin&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inv(x) = 1/x&quot;</span><span class="p">,</span>
        <span class="c1"># ^ Custom operator (julia syntax)</span>
    <span class="p">],</span>
    <span class="n">extra_sympy_mappings</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;inv&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">x</span><span class="p">},</span>
    <span class="c1"># ^ Define operator for SymPy as well</span>
    <span class="n">elementwise_loss</span><span class="o">=</span><span class="s2">&quot;loss(prediction, target) = (prediction - target)^2&quot;</span><span class="p">,</span>
    <span class="c1"># ^ Custom loss function (julia syntax)</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">get_best</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected IPython. Loading juliacall extension. See https://juliapy.github.io/PythonCall.jl/stable/compat/#IPython
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/adialumadjeng/Projects/IE-in-AI-SR/ie-in-ai-SR/PySR/pysr/sr.py:1307: UserWarning: Note: it looks like you are running in Jupyter. The progress bar will be turned off.
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Compiling Julia backend...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ Info: Started!
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PySRRegressor.equations_ = [
	    pick         score                                           equation  \
	0         0.000000e+00                                        -0.28737655   
	1         6.517324e-01                                    inv(-0.9722635)   
	2         1.173444e+00                                    -1.0623512 + x1   
	3         5.811268e-04                        (x1 * 1.023314) + -1.063143   
	4         6.474519e-01                        (cos(x0) * -1.2888113) + x1   
	5         1.890811e-01                      (x0 * x0) + (-1.3955851 + x1)   
	6         6.862176e-03            x1 + (cos(1.2634565 * x0) * -1.4043528)   
	7         1.248710e+00             (-2.222682 * cos(x0)) + (cos(x1) + x1)   
	8         1.487991e+00  (cos(x1 * -1.4887787) + (cos(x0) * -1.9921768)...   
	9         1.545694e+00  x1 + ((-1.98271 + cos(x1 * 1.5322164)) + (x0 *...   
	10        6.737755e-04  x1 + ((-1.98271 + cos((x1 + 0.00049597875) * 1...   
	11        4.849703e-07  x1 + ((-2.5366383 + (cos((x1 + 0.0004973122) *...   
	12  &gt;&gt;&gt;&gt;  1.667074e+00  ((x1 * -0.5317515) * x1) + ((cos(x1) + (0.1568...   
	13        1.069344e-01  (x1 * (x1 * sin(-1.6534529))) + ((cos(cos(-1.6...   
	14        1.757294e-02  (x1 * (x1 * sin(-1.6534529))) + ((cos(cos(-1.6...   
	
	        loss  complexity  
	0   1.146961           1  
	1   0.597730           2  
	2   0.184878           3  
	3   0.184663           5  
	4   0.096648           6  
	5   0.079998           7  
	6   0.079451           8  
	7   0.022792           9  
	8   0.001162          11  
	9   0.000248          12  
	10  0.000247          14  
	11  0.000247          16  
	12  0.000047          17  
	13  0.000038          19  
	14  0.000037          20  
]
complexity                                                      17
loss                                                      0.000047
score                                                     1.667074
equation         ((x1 * -0.5317515) * x1) + ((cos(x1) + (0.1568...
sympy_format     -0.5317515*x1**2 + x1 - 2.1616898*cos(x0) + co...
lambda_format    PySRFunction(X=&gt;-0.5317515*x1**2 + x1 - 2.1616...
Name: 12, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="gfn-sr">
<h3>3-2: GFN-SR<a class="headerlink" href="#gfn-sr" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN THIS CELL. Do not change.</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;gfn-sr&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">train</span> <span class="kn">import</span> <span class="n">train_gfn_sr</span>

<span class="c1"># Define the arguments (simulating command-line arguments)</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Call the training function</span>
<span class="n">model</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">errs</span><span class="p">,</span> <span class="n">avg_mses</span><span class="p">,</span> <span class="n">top_mses</span> <span class="o">=</span> <span class="n">train_gfn_sr</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_epochs</span><span class="p">,</span> <span class="n">show_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>training started with device cpu
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.905:   1%|          | 1/100 [00:00&lt;00:23,  4.23it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>action_fns:  [None, 0, 1, &lt;built-in method square of type object at 0x2c2df3810&gt;, &lt;built-in method sqrt of type object at 0x2c2df3810&gt;, &lt;built-in method log of type object at 0x2c2df3810&gt;, &lt;built-in method cos of type object at 0x2c2df3810&gt;, &lt;built-in method sin of type object at 0x2c2df3810&gt;, &lt;built-in method exp of type object at 0x2c2df3810&gt;, &lt;built-in method mul of type object at 0x2c2df3810&gt;, &lt;built-in method add of type object at 0x2c2df3810&gt;, &lt;built-in method div of type object at 0x2c2df3810&gt;, &lt;built-in method sub of type object at 0x2c2df3810&gt;]
action_arities:  tensor([0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2])
action_names : [&#39;c&#39;, &#39;x1&#39;, &#39;x2&#39;, &#39;square&#39;, &#39;sqrt&#39;, &#39;log&#39;, &#39;cos&#39;, &#39;sin&#39;, &#39;exp&#39;, &#39;*&#39;, &#39;+&#39;, &#39;/&#39;, &#39;-&#39;]

new best reward (vanilla): 0.3896152377128601
mse (pre/post optimized): 53.37709426879883/55.80449295043945
best encoding: tensor([11,  9,  9,  1,  1,  1,  0])
((x1) * (x1)) / ((x1) * (0.35))
expr: 2.85714285714286*x1
action_fns:  [None, 0, 1, &lt;built-in method square of type object at 0x2c2df3810&gt;, &lt;built-in method sqrt of type object at 0x2c2df3810&gt;, &lt;built-in method log of type object at 0x2c2df3810&gt;, &lt;built-in method cos of type object at 0x2c2df3810&gt;, &lt;built-in method sin of type object at 0x2c2df3810&gt;, &lt;built-in method exp of type object at 0x2c2df3810&gt;, &lt;built-in method mul of type object at 0x2c2df3810&gt;, &lt;built-in method add of type object at 0x2c2df3810&gt;, &lt;built-in method div of type object at 0x2c2df3810&gt;, &lt;built-in method sub of type object at 0x2c2df3810&gt;]
action_arities:  tensor([0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2])
action_names : [&#39;c&#39;, &#39;x1&#39;, &#39;x2&#39;, &#39;square&#39;, &#39;sqrt&#39;, &#39;log&#39;, &#39;cos&#39;, &#39;sin&#39;, &#39;exp&#39;, &#39;*&#39;, &#39;+&#39;, &#39;/&#39;, &#39;-&#39;]

new best reward (vanilla): 0.685813307762146
mse (pre/post optimized): 17.840843200683594/17.840843200683594
best encoding: tensor([ 9,  1, 12, -1, -1,  1,  2])
(x1) * ((x1) - (x2))
expr: x1*(x1 - x2)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.427:  59%|█████▉    | 59/100 [00:02&lt;00:01, 24.31it/s] 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>action_fns:  [None, 0, 1, &lt;built-in method square of type object at 0x2c2df3810&gt;, &lt;built-in method sqrt of type object at 0x2c2df3810&gt;, &lt;built-in method log of type object at 0x2c2df3810&gt;, &lt;built-in method cos of type object at 0x2c2df3810&gt;, &lt;built-in method sin of type object at 0x2c2df3810&gt;, &lt;built-in method exp of type object at 0x2c2df3810&gt;, &lt;built-in method mul of type object at 0x2c2df3810&gt;, &lt;built-in method add of type object at 0x2c2df3810&gt;, &lt;built-in method div of type object at 0x2c2df3810&gt;, &lt;built-in method sub of type object at 0x2c2df3810&gt;]
action_arities:  tensor([0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2])
action_names : [&#39;c&#39;, &#39;x1&#39;, &#39;x2&#39;, &#39;square&#39;, &#39;sqrt&#39;, &#39;log&#39;, &#39;cos&#39;, &#39;sin&#39;, &#39;exp&#39;, &#39;*&#39;, &#39;+&#39;, &#39;/&#39;, &#39;-&#39;]

new best reward (vanilla): 0.820941686630249
mse (pre/post optimized): 3.0413200855255127/3.0413200855255127
best encoding: tensor([ 9, 10, 12,  1,  2,  1,  2])
((x1) + (x2)) * ((x1) - (x2))
expr: (x1 - x2)*(x1 + x2)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.137: 100%|██████████| 100/100 [00:03&lt;00:00, 25.39it/s]
</pre></div>
</div>
<img alt="../_images/3cc4b9dd6b6cfb3f4c81eed2df304b41d7a2ca349b58c492813c6f0e7bd352f9.png" src="../_images/3cc4b9dd6b6cfb3f4c81eed2df304b41d7a2ca349b58c492813c6f0e7bd352f9.png" />
</div>
</div>
</section>
<section id="question-3-total-2pts">
<h3>Question 3 (total 2pts)<a class="headerlink" href="#question-3-total-2pts" title="Link to this heading">#</a></h3>
<section id="q3a-0-5pts-for-the-complete-output-of-pysr-check-the-hall-of-fame-csv-file-what-is-meant-by-the-complexity-of-pysr">
<h4>Q3a - (0.5pts) For the complete output of PySR, check the hall_of_fame-csv-file. What is meant by the complexity of PySR?<a class="headerlink" href="#q3a-0-5pts-for-the-complete-output-of-pysr-check-the-hall-of-fame-csv-file-what-is-meant-by-the-complexity-of-pysr" title="Link to this heading">#</a></h4>
</section>
<section id="q3b-1-5pts-what-are-the-expressions-generated-for-the-equation-y-x1-2-x1-2-x2-1-by-all-three-symbolic-regression-methods-e-g-gplearn-pysr-gfn-sr-for-pysr-choose-an-equation-of-appropriate-complexity-to-compare-which-method-do-you-prefer-now-and-why">
<h4>Q3b - (1.5pts): What are the expressions generated for the equation y = x1^2 - x1^2 + x2 - 1 by all three symbolic regression methods (e.g. GPLearn, PySR, GFN-SR)? For PySR, choose an equation of appropriate complexity to compare. Which method do you prefer now and why?<a class="headerlink" href="#q3b-1-5pts-what-are-the-expressions-generated-for-the-equation-y-x1-2-x1-2-x2-1-by-all-three-symbolic-regression-methods-e-g-gplearn-pysr-gfn-sr-for-pysr-choose-an-equation-of-appropriate-complexity-to-compare-which-method-do-you-prefer-now-and-why" title="Link to this heading">#</a></h4>
</section>
</section>
<section id="question-4-total-2pts">
<h3>Question 4 (total 2pts)<a class="headerlink" href="#question-4-total-2pts" title="Link to this heading">#</a></h3>
<section id="q4a-0-5pts-compare-the-generated-decision-rules-of-the-non-symbolic-regressors-against-each-of-the-symbolic-expressions-which-one-do-you-prefer-and-why-show-how-you-compare-the-methods">
<h4>Q4a - (0.5pts): Compare the generated decision rules of the non-symbolic regressors against each of the symbolic expressions. Which one do you prefer and why? Show how you compare the methods.<a class="headerlink" href="#q4a-0-5pts-compare-the-generated-decision-rules-of-the-non-symbolic-regressors-against-each-of-the-symbolic-expressions-which-one-do-you-prefer-and-why-show-how-you-compare-the-methods" title="Link to this heading">#</a></h4>
</section>
<section id="q4b-1-5pts-create-another-example-equation-that-results-in-a-less-interpretable-solution-for-the-non-symbolic-regression-methods-in-comparison-to-the-symbolic-regression-compare-these-decision-rules-that-you-generated-with-dt-and-rf-to-the-symbolic-regressors-in-terms-of-complexity-compactness-and-r-squared-report-all-your-findings">
<h4>Q4b (1.5pts): Create another example equation that results in a less interpretable solution for the non-symbolic regression methods in comparison to the symbolic regression. Compare these decision rules that you generated with DT and RF to the symbolic regressors in terms of complexity, compactness and R-squared. Report all your findings.<a class="headerlink" href="#q4b-1-5pts-create-another-example-equation-that-results-in-a-less-interpretable-solution-for-the-non-symbolic-regression-methods-in-comparison-to-the-symbolic-regression-compare-these-decision-rules-that-you-generated-with-dt-and-rf-to-the-symbolic-regressors-in-terms-of-complexity-compactness-and-r-squared-report-all-your-findings" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">####</span>
<span class="c1"># (Question 4) YOUR CODE</span>
<span class="c1">####</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="section-4-comparing-the-symbolic-regression-methods">
<h2>Section 4: Comparing the Symbolic Regression Methods<a class="headerlink" href="#section-4-comparing-the-symbolic-regression-methods" title="Link to this heading">#</a></h2>
<p>In this section, we will explore and compare GPLearn, PySR, and GFN-SR using more complex equations and additional features in our dataset. We will also check the robustness of these methods, and finally, apply them to real-world datasets.</p>
<section id="increasing-the-complexity">
<h3>4-1: Increasing the complexity<a class="headerlink" href="#increasing-the-complexity" title="Link to this heading">#</a></h3>
<p>We increase the difficulty of the equation by:</p>
<ol class="arabic simple">
<li><p>Increasing the length of the expression/depth of the expression tree</p></li>
<li><p>Increase the number of features</p></li>
</ol>
<section id="question-5-3pts-for-all-six-functions-below-run-the-three-symbolic-regression-methods-report-its-performance-in-terms-of-the-mse-and-r2-score-describe-what-you-observe-and-conclude">
<h4>Question 5 (3pts): For all six functions below, run the three symbolic regression methods. Report its performance in terms of the MSE and R2-score. Describe what you observe and conclude.<a class="headerlink" href="#question-5-3pts-for-all-six-functions-below-run-the-three-symbolic-regression-methods-report-its-performance-in-terms-of-the-mse-and-r2-score-describe-what-you-observe-and-conclude" title="Link to this heading">#</a></h4>
<p>You can do this by creating a train set of a 100 samples, and a test set of a 100 samples. When needed, you may choose the parameters yourself accordingly.</p>
<p>Note: to run GFN-SR, you have to change the function in <a class="reference external" href="http://train.py">train.py</a> of ./gfn-sr</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN THIS CELL. Do not change.</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Simple Polynomial</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Polynomial with interaction terms</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Polynomial with higher degree terms</span>
<span class="n">y3</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Trigonometric Functions</span>
<span class="n">y4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Mixed functions</span>
<span class="n">y5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create train and test samples for y1 up to y5.</span>

<span class="c1">########</span>

<span class="c1"># GPLearn</span>
<span class="c1"># Training samples</span>
<span class="n">y1_train</span> <span class="o">=</span> <span class="n">y1</span>
<span class="n">y2_train</span> <span class="o">=</span> <span class="n">y2</span>
<span class="n">y3_train</span> <span class="o">=</span> <span class="n">y3</span>
<span class="n">y4_train</span> <span class="o">=</span> <span class="n">y4</span>
<span class="n">y5_train</span> <span class="o">=</span> <span class="n">y5</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span>

<span class="n">train_df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;y1&#39;</span><span class="p">:</span> <span class="n">y1_train</span><span class="p">})</span>
<span class="n">train_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;y2&#39;</span><span class="p">:</span> <span class="n">y2_train</span><span class="p">})</span>
<span class="n">train_df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;y3&#39;</span><span class="p">:</span> <span class="n">y3_train</span><span class="p">})</span>
<span class="n">train_df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;y4&#39;</span><span class="p">:</span> <span class="n">y4_train</span><span class="p">})</span>
<span class="n">train_df5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;y5&#39;</span><span class="p">:</span> <span class="n">y5_train</span><span class="p">})</span>

<span class="c1"># # Testing samples</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span>
<span class="c1">########</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run GPLearn</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_squared_error</span>

<span class="c1">########</span>

<span class="c1"># Define parameters for SymbolicRegressor</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;population_size&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
    <span class="s1">&#39;generations&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s1">&#39;stopping_criteria&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;p_crossover&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="s1">&#39;p_subtree_mutation&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;p_hoist_mutation&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="s1">&#39;p_point_mutation&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;max_samples&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
    <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;parsimony_coefficient&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Loop through equations</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y_train</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">y1_train</span><span class="p">,</span> <span class="n">y2_train</span><span class="p">,</span> <span class="n">y3_train</span><span class="p">,</span> <span class="n">y4_train</span><span class="p">,</span> <span class="n">y5_train</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Equation </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">:&#39;</span><span class="p">)</span>
    <span class="c1"># Create and fit SymbolicRegressor</span>
    <span class="n">est_gp</span> <span class="o">=</span> <span class="n">SymbolicRegressor</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">est_gp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Print the generated equation</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Generated Equation:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">est_gp</span><span class="o">.</span><span class="n">_program</span><span class="p">)</span>
    
    <span class="c1"># Generate predictions and calculate scores</span>
    <span class="n">y_gp</span> <span class="o">=</span> <span class="n">est_gp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R-squared: &#39;</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_gp</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MSE: &#39;</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_gp</span><span class="p">))</span>

<span class="c1">#######</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run PySR</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;PySR&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">pysr</span> <span class="kn">import</span> <span class="n">PySRRegressor</span>

<span class="k">def</span> <span class="nf">positive_r2</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="n">ss_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_true</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">ss_res</span> <span class="o">/</span> <span class="n">ss_tot</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r2</span>

<span class="k">def</span> <span class="nf">mse_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1">#######</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">PySRRegressor</span><span class="p">(</span>
    <span class="n">niterations</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>  <span class="c1"># &lt; Increase me for better results</span>
    <span class="n">binary_operators</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">],</span>
    <span class="n">unary_operators</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;cos&quot;</span><span class="p">,</span>
        <span class="s2">&quot;exp&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sin&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inv(x) = 1/x&quot;</span><span class="p">,</span>
        <span class="c1"># ^ Custom operator (julia syntax)</span>
    <span class="p">],</span>
    <span class="n">extra_sympy_mappings</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;inv&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">x</span><span class="p">},</span>
    <span class="c1"># ^ Define operator for SymPy as well</span>
    <span class="n">elementwise_loss</span><span class="o">=</span><span class="s2">&quot;loss(prediction, target) = (prediction - target)^2&quot;</span><span class="p">,</span>
    <span class="c1"># ^ Custom loss function (julia syntax)</span>
<span class="p">)</span>


<span class="c1"># List of y-values to iterate over</span>
<span class="n">equations</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">y4</span><span class="p">,</span> <span class="n">y5</span><span class="p">]</span>

<span class="c1"># Loop over each equation</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">equation</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">equations</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Equation </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">:&#39;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">equation</span><span class="p">)</span>
    <span class="n">y_pysr</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">get_best</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MSE:&#39;</span><span class="p">,</span> <span class="n">mse_loss</span><span class="p">(</span><span class="n">equation</span><span class="p">,</span> <span class="n">y_pysr</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R-Squared:&#39;</span><span class="p">,</span> <span class="n">positive_r2</span><span class="p">(</span><span class="n">equation</span><span class="p">,</span> <span class="n">y_pysr</span><span class="p">))</span>

<span class="c1">#######</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run GFN-SR</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;gfn-sr&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">train</span> <span class="kn">import</span> <span class="n">train_gfn_sr</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>

<span class="c1">#########</span>
<span class="c1"># Define the arguments (simulating command-line arguments)</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Call the training function</span>
<span class="n">model</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">errs</span><span class="p">,</span> <span class="n">avg_mses</span><span class="p">,</span> <span class="n">top_mses</span> <span class="o">=</span> <span class="n">train_gfn_sr</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_epochs</span><span class="p">,</span> <span class="n">show_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#########</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="optional-question-6-0-5pts-increase-the-number-of-features-by-one-and-compare-the-performances-of-the-three-methods-based-on-your-own-equation-involving-three-features">
<h4>[OPTIONAL] Question 6 (0.5pts): Increase the number of features by one and compare the performances of the three methods based on your own equation involving three features.<a class="headerlink" href="#optional-question-6-0-5pts-increase-the-number-of-features-by-one-and-compare-the-performances-of-the-three-methods-based-on-your-own-equation-involving-three-features" title="Link to this heading">#</a></h4>
</section>
</section>
<section id="sensitivity-to-noise">
<h3>4-2: Sensitivity to noise<a class="headerlink" href="#sensitivity-to-noise" title="Link to this heading">#</a></h3>
<p>Now you’ll compare the methods to each other in terms of robustness. This means we add noise to the dataset and check how it performs.</p>
<section id="optional-question-7-0-5pts-add-a-noise-term-to-your-data-set-this-noise-should-be-normally-distributed-between-with-a-mean-of-0-and-standard-deviation-of-0-02-considering-performance-you-may-choose-a-metric-yourself-and-runtime-which-method-is-most-robust">
<h4>[OPTIONAL] Question 7 (0.5pts): Add a noise term to your data set. This noise should be normally distributed between with a mean of 0 and standard deviation of 0.02. Considering performance (you may choose a metric yourself) and runtime, which method is most robust?<a class="headerlink" href="#optional-question-7-0-5pts-add-a-noise-term-to-your-data-set-this-noise-should-be-normally-distributed-between-with-a-mean-of-0-and-standard-deviation-of-0-02-considering-performance-you-may-choose-a-metric-yourself-and-runtime-which-method-is-most-robust" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">########</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Generate noise with mean 0 and std dev 0.2</span>
<span class="n">mean</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">std_dev</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">std_dev</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Add noise to X</span>
<span class="n">X_noisy</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span> <span class="n">noise</span>

<span class="c1">#######</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="application-to-real-world-benchmark-dataset-ai-feynman">
<h3>4-3: Application to real-world benchmark dataset: AI Feynman<a class="headerlink" href="#application-to-real-world-benchmark-dataset-ai-feynman" title="Link to this heading">#</a></h3>
<p>In this section, we delve into symbolic regression using equations from the AI Feynman database—a well-established collection of 100 physics-inspired equations curated by Udrescu &amp; Tegmark (2019). These equations serve as a rigorous benchmark for evaluating the capabilities of symbolic regression methods.</p>
<p>Our goal is to assess how effectively GPLearn, PySR, and GFN-SR can uncover and represent these complex relationships. By applying these methods to the AI Feynman equations, we aim to gain insights into their performance in discovering fundamental laws and relationships, highlighting their strengths and areas for further improvement in practical applications.</p>
</section>
<section id="optional-question-8-2pts-go-to-https-arxiv-org-abs-1905-11481-and-find-equations-i-12-2-i-48-20-i-13-4-i-27-6-i-18-12-and-i-29-16-what-can-you-say-about-the-structure-of-these-functions-then-use-gplearn-pysr-and-gfn-sr-on-these-equations-you-may-use-a-dataset-of-a-50-samples-with-values-between-1-and-10-without-noise-based-on-your-findings-in-the-previous-question-which-method-do-you-think-works-best-is-there-one-method-overall-or-do-you-think-one-method-works-best-for-certain-equations">
<h3>[OPTIONAL] Question 8 (2pts): Go to <a class="reference external" href="https://arxiv.org/abs/1905.11481">https://arxiv.org/abs/1905.11481</a> and find equations I.12.2, I.48.20, I.13.4, I.27.6, I.18.12 and I.29.16. What can you say about the structure of these functions? Then, Use GPLearn, PySR and GFN-SR on these equations. You may use a dataset of a 50 samples with values between 1 and 10 (without noise). Based on your findings in the previous question, which method do you think works best? Is there one method overall, or do you think one method works best for certain equations?<a class="headerlink" href="#optional-question-8-2pts-go-to-https-arxiv-org-abs-1905-11481-and-find-equations-i-12-2-i-48-20-i-13-4-i-27-6-i-18-12-and-i-29-16-what-can-you-say-about-the-structure-of-these-functions-then-use-gplearn-pysr-and-gfn-sr-on-these-equations-you-may-use-a-dataset-of-a-50-samples-with-values-between-1-and-10-without-noise-based-on-your-findings-in-the-previous-question-which-method-do-you-think-works-best-is-there-one-method-overall-or-do-you-think-one-method-works-best-for-certain-equations" title="Link to this heading">#</a></h3>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./week3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-0-introduction">Section 0: Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-generation">Data Generation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-1-introduction-to-non-symbolic-regression-methods">Section 1: Introduction to Non-Symbolic Regression Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-train-and-testdatasets">Create train- and testdatasets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training-the-models">Training the models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-1pts-total">Question 1 (1pts total)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q1a-0-5pts-describe-what-results-you-see-in-the-figure">Q1a - (0.5pts): Describe what results you see in the figure.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q1b-0-5pts-can-you-think-of-at-least-two-possible-limitations-to-using-non-symbolic-regression-methods-for-symbolic-regression">Q1b - (0.5pts): Can you think of at least two possible limitations to using non-symbolic regression methods for symbolic regression?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-2-introduction-to-symbolic-regression-methods-gplearn">Section 2: Introduction to Symbolic Regression Methods (GPLearn)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gplearn">2-1: GPLearn</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-1pts-describe-what-results-you-see-in-the-figure-what-are-your-thoughts-so-far-on-using-gplearn-for-symbolic-regression">Question 2 (1pts): Describe what results you see in the figure. What are your thoughts so far on using GPLearn for (symbolic) regression?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-3-comparing-non-symbolic-regression-vs-symbolic-regression">Section 3: Comparing Non-Symbolic Regression vs. Symbolic Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pysr">3-1: PySR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gfn-sr">3-2: GFN-SR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-3-total-2pts">Question 3 (total 2pts)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q3a-0-5pts-for-the-complete-output-of-pysr-check-the-hall-of-fame-csv-file-what-is-meant-by-the-complexity-of-pysr">Q3a - (0.5pts) For the complete output of PySR, check the hall_of_fame-csv-file. What is meant by the complexity of PySR?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q3b-1-5pts-what-are-the-expressions-generated-for-the-equation-y-x1-2-x1-2-x2-1-by-all-three-symbolic-regression-methods-e-g-gplearn-pysr-gfn-sr-for-pysr-choose-an-equation-of-appropriate-complexity-to-compare-which-method-do-you-prefer-now-and-why">Q3b - (1.5pts): What are the expressions generated for the equation y = x1^2 - x1^2 + x2 - 1 by all three symbolic regression methods (e.g. GPLearn, PySR, GFN-SR)? For PySR, choose an equation of appropriate complexity to compare. Which method do you prefer now and why?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-4-total-2pts">Question 4 (total 2pts)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q4a-0-5pts-compare-the-generated-decision-rules-of-the-non-symbolic-regressors-against-each-of-the-symbolic-expressions-which-one-do-you-prefer-and-why-show-how-you-compare-the-methods">Q4a - (0.5pts): Compare the generated decision rules of the non-symbolic regressors against each of the symbolic expressions. Which one do you prefer and why? Show how you compare the methods.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#q4b-1-5pts-create-another-example-equation-that-results-in-a-less-interpretable-solution-for-the-non-symbolic-regression-methods-in-comparison-to-the-symbolic-regression-compare-these-decision-rules-that-you-generated-with-dt-and-rf-to-the-symbolic-regressors-in-terms-of-complexity-compactness-and-r-squared-report-all-your-findings">Q4b (1.5pts): Create another example equation that results in a less interpretable solution for the non-symbolic regression methods in comparison to the symbolic regression. Compare these decision rules that you generated with DT and RF to the symbolic regressors in terms of complexity, compactness and R-squared. Report all your findings.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-4-comparing-the-symbolic-regression-methods">Section 4: Comparing the Symbolic Regression Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#increasing-the-complexity">4-1: Increasing the complexity</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#question-5-3pts-for-all-six-functions-below-run-the-three-symbolic-regression-methods-report-its-performance-in-terms-of-the-mse-and-r2-score-describe-what-you-observe-and-conclude">Question 5 (3pts): For all six functions below, run the three symbolic regression methods. Report its performance in terms of the MSE and R2-score. Describe what you observe and conclude.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-question-6-0-5pts-increase-the-number-of-features-by-one-and-compare-the-performances-of-the-three-methods-based-on-your-own-equation-involving-three-features">[OPTIONAL] Question 6 (0.5pts): Increase the number of features by one and compare the performances of the three methods based on your own equation involving three features.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sensitivity-to-noise">4-2: Sensitivity to noise</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-question-7-0-5pts-add-a-noise-term-to-your-data-set-this-noise-should-be-normally-distributed-between-with-a-mean-of-0-and-standard-deviation-of-0-02-considering-performance-you-may-choose-a-metric-yourself-and-runtime-which-method-is-most-robust">[OPTIONAL] Question 7 (0.5pts): Add a noise term to your data set. This noise should be normally distributed between with a mean of 0 and standard deviation of 0.02. Considering performance (you may choose a metric yourself) and runtime, which method is most robust?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application-to-real-world-benchmark-dataset-ai-feynman">4-3: Application to real-world benchmark dataset: AI Feynman</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-question-8-2pts-go-to-https-arxiv-org-abs-1905-11481-and-find-equations-i-12-2-i-48-20-i-13-4-i-27-6-i-18-12-and-i-29-16-what-can-you-say-about-the-structure-of-these-functions-then-use-gplearn-pysr-and-gfn-sr-on-these-equations-you-may-use-a-dataset-of-a-50-samples-with-values-between-1-and-10-without-noise-based-on-your-findings-in-the-previous-question-which-method-do-you-think-works-best-is-there-one-method-overall-or-do-you-think-one-method-works-best-for-certain-equations">[OPTIONAL] Question 8 (2pts): Go to https://arxiv.org/abs/1905.11481 and find equations I.12.2, I.48.20, I.13.4, I.27.6, I.18.12 and I.29.16. What can you say about the structure of these functions? Then, Use GPLearn, PySR and GFN-SR on these equations. You may use a dataset of a 50 samples with values between 1 and 10 (without noise). Based on your findings in the previous question, which method do you think works best? Is there one method overall, or do you think one method works best for certain equations?</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png"></a>
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>